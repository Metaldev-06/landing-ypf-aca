---
import { Image } from "astro:assets";
import logo from "../../../public/img/logo-diaz-servicios.svg";
import logoACA from "../../../public/img/logo-aca.svg";

const pathname = new URL(Astro.request.url).pathname;
const currentPath = pathname.slice(1);
---

<header class="header__container" transition:persist>
  <div class="header__content">
    <picture class="header__logo">
      <Image src={logo} alt="Logo Diaz Servicios" loading="eager" />
    </picture>

    <nav class="header__nav">
      <a href="/" class={currentPath === "" ? "active" : ""}>Inicio</a>
      <a href="/menu" class={currentPath === "menu" ? "active" : ""}>Menú</a>
      <!-- <a href="/" class={''}>Promociones</a> -->
      <a href="/hotel" class={currentPath === "hotel" ? "active" : ""}>Hotel</a>
      <!-- <a href="/contact" class={currentPath === "contact" ? "active" : ""}
        >Contacto</a
      > -->
    </nav>

    <picture class="header__logo--secondary">
      <Image
        src={logoACA}
        alt="Logo Automóvil Club Argentino"
        loading="eager"
      />
    </picture>
  </div>
</header>

<header class="header__container--mobile" transition:persist>
  <div class="header__images">
    <picture class="header__logo">
      <Image src={logo} alt="Logo Diaz Servicios" loading="eager" width={50} />
    </picture>

    <picture class="header__logo--secondary">
      <Image
        src={logoACA}
        alt="Logo Automóvil Club Argentino"
        loading="eager"
        width={50}
      />
    </picture>
  </div>

  <div class="header__content--mobile">
    <nav class="header__nav">
      <a href="/" class={currentPath === "" ? "active" : ""}>Inicio</a>
      <a href="/menu" class={currentPath === "menu" ? "active" : ""}>Menú</a>
      <!-- <a href="/" class={''}>Promociones</a> -->
      <a href="/hotel" class={currentPath === "hotel" ? "active" : ""}>Hotel</a>
      <!-- <a href="/contact" class={currentPath === "contact" ? "active" : ""}
        >Contacto</a
      > -->
    </nav>
  </div>
</header>

<style lang="scss">
  @import "../../styles/_variables.scss", "../../styles/_mediaqueries.scss";

  .header__container {
    width: 100%;
    height: 80px;
    position: fixed;
    top: 0;
    z-index: 1000;
    transition: background-color 0.3s ease;
    display: flex;
    justify-content: center;
    align-items: center;

    @include media-up(mobileXL) {
      display: none;
    }

    .header__content {
      width: $full-width;
      max-width: $max-width;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 0 auto;
    }
  }

  .header__nav {
    display: flex;
    gap: 0.5rem;

    a {
      padding: 0.5rem;
      font-weight: bold;
      color: $white-color;
      opacity: 0.8;

      & {
        cursor: pointer;
        position: relative;
        border: none;
        background: none;
        transition-timing-function: cubic-bezier(0.25, 0.8, 0.25, 1);
        transition-duration: 400ms;
        transition-property: color;
      }
      &:focus,
      &:hover {
        color: $white-color-secondary;
        opacity: 1;
      }

      &:focus:after,
      &:hover:after {
        width: 100%;
        left: 0%;
      }
      &:after {
        content: "";
        pointer-events: none;
        bottom: -2px;
        left: 50%;
        position: absolute;
        width: 0%;
        height: 2px;
        background: $white-color;
        transition-timing-function: cubic-bezier(0.25, 0.8, 0.25, 1);
        transition-duration: 400ms;
        transition-property: width, left;
      }
    }

    .active {
      opacity: 1;
    }
  }

  .header__container--mobile {
    display: none;
    width: 100%;
    // height: 100px;
    position: fixed;
    top: 0;
    z-index: 1000;
    transition: background-color 0.3s ease;
    justify-content: center;
    align-items: center;
    padding-bottom: 0.5rem;

    @include media-up(mobileXL) {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    .header__images {
      display: flex;
      justify-content: center;
      align-items: center;
    }
  }

  .header-sticky {
    background-color: $black-color;
  }
</style>

<script>
  const $ = (selector: string) => document.querySelector(selector);

  const header = $(".header__container");
  const headerMobile = $(".header__container--mobile");

  let isSticky = false;

  const activedFixedScroll = () => {
    const scrollY = window.scrollY;

    if (!header || !headerMobile) return;

    if (scrollY > 0 && !isSticky) {
      header.classList.add("header-sticky");
      headerMobile.classList.add("header-sticky");
      isSticky = true;
    } else if (scrollY === 0 && isSticky) {
      header.classList.remove("header-sticky");
      headerMobile.classList.remove("header-sticky");
      isSticky = false;
    }
  };

  document.addEventListener("scroll", activedFixedScroll);
</script>
